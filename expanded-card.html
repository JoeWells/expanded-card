<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../neon-animation/neon-animation-runner-behaviour.html">

<dom-module id="expanded-card">
  <template>
    <div class="vertical layout">
      <paper-icon-button class="self-end" id="expandButton"></paper-icon-button>
      <iron-collapse id="contentCollapse" opened="{{expanded}}">
        <content></content>
      </iron-collapse>
    </div>
  </template>

  <script>
  Polymer({
    is: 'expanded-card',
    behaviours: [Polymer.NeonAnimationRunnerBehaviour],
    properties: {
      expanded: {
        type: Boolean,
        value: false
      },
      expandMoreTitle: {
        type: String,
        value: "Show More"
      },
      expandLessTitle: {
        type: String,
        value: "Show Less"
      },
      enableRotateAnimation: {
        type: Boolean,
        value: true
      },
      expandMoreIcon: {
        type: String,
        value: "expand-more"
      },
      expandLessIcon: {
        type: String,
        value: "expand-less"
      },
      animationConfig: {
        value: function() {
          return {
            'rotateIcon': {
              name: 'transform-animation',
              node: this.$.expandButton,
              transformFrom: "rotate(0)",
              transformTo: "rotate(180deg)",
              timing: {duration: 500}
            }
          }
        }
      }
    },
    listeners: {
      'neon-animation-finish': '_onNeonAnimationFinish'
    },
    _onNeonAnimationFinish: function() {
      if(this.expanded) {
        this.$.iconButton.icon = "icons:expand-less";
      }
      else {
        this.$.iconButton.icon = "icons:expand-more";
      }
      this.$.iconButton.disabled = false;
    },

    // Fires when an instance of the element is created
    created: function() {},

    // Fires when the local DOM has been fully prepared
    ready: function() {},

    // Fires when the element was inserted into the document
    attached: function() {},

    // Fires when the element was removed from the document
    detached: function() {},

    // Fires when an attribute was added, removed, or updated
    attributeChanged: function(name, type) {
      if(name == "expanded") {
        //Get new expanded attribute
        var expanded = this.getAtrribute(name);

        //Set title
        if (expanded) {
          this.$.expandButton.title = this.expandLessTitle;
        }
        else {
          this.$.expandButton.title = this.expandMoreTitle;
        }

        if((this.$.expandButton.icon == this.) && ) {
          return;
        }

        //Disable button to prevent clicks
        this.$.expandButton.disabled = true;
        //Play rotate animation
        this.playAnimation('rotateIcon');


      }
    }
  });
  </script>
</dom-module>
